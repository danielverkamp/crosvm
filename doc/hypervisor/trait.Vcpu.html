<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="A virtual CPU holding a virtualized hardware thread’s state, such as registers and interrupt state, which may be used to execute virtual machines."><meta name="keywords" content="rust, rustlang, rust-lang, Vcpu"><title>Vcpu in hypervisor - Rust</title><link rel="preload" as="font" type="font/woff2" crossorigin href="../SourceSerif4-Regular.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../FiraSans-Regular.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../FiraSans-Medium.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../SourceCodePro-Regular.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../SourceSerif4-Bold.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../SourceCodePro-Semibold.ttf.woff2"><link rel="stylesheet" type="text/css" href="../normalize.css"><link rel="stylesheet" type="text/css" href="../rustdoc.css" id="mainThemeStyle"><link rel="stylesheet" type="text/css" href="../ayu.css" disabled><link rel="stylesheet" type="text/css" href="../dark.css" disabled><link rel="stylesheet" type="text/css" href="../light.css" id="themeStyle"><script id="default-settings" ></script><script src="../storage.js"></script><script src="../crates.js"></script><script defer src="../main.js"></script>
    <noscript><link rel="stylesheet" href="../noscript.css"></noscript><link rel="alternate icon" type="image/png" href="../favicon-16x16.png"><link rel="alternate icon" type="image/png" href="../favicon-32x32.png"><link rel="icon" type="image/svg+xml" href="../favicon.svg"></head><body class="rustdoc trait"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="mobile-topbar"><button class="sidebar-menu-toggle">&#9776;</button><a class="sidebar-logo" href="../hypervisor/index.html"><div class="logo-container"><img class="rust-logo" src="../rust-logo.svg" alt="logo"></div>
        </a><h2 class="location"></h2>
    </nav>
    <nav class="sidebar"><a class="sidebar-logo" href="../hypervisor/index.html"><div class="logo-container"><img class="rust-logo" src="../rust-logo.svg" alt="logo"></div>
        </a><h2 class="location"><a href="#">Vcpu</a></h2><div class="sidebar-elems"><section><div class="block"><h3 class="sidebar-title"><a href="#required-methods">Required Methods</a></h3><ul><li><a href="#tymethod.as_vcpu">as_vcpu</a></li><li><a href="#tymethod.enable_raw_capability">enable_raw_capability</a></li><li><a href="#tymethod.handle_hyperv_hypercall">handle_hyperv_hypercall</a></li><li><a href="#tymethod.handle_io">handle_io</a></li><li><a href="#tymethod.handle_mmio">handle_mmio</a></li><li><a href="#tymethod.handle_rdmsr">handle_rdmsr</a></li><li><a href="#tymethod.handle_wrmsr">handle_wrmsr</a></li><li><a href="#tymethod.id">id</a></li><li><a href="#tymethod.pvclock_ctrl">pvclock_ctrl</a></li><li><a href="#tymethod.run">run</a></li><li><a href="#tymethod.set_immediate_exit">set_immediate_exit</a></li><li><a href="#tymethod.set_local_immediate_exit">set_local_immediate_exit</a></li><li><a href="#tymethod.set_local_immediate_exit_fn">set_local_immediate_exit_fn</a></li><li><a href="#tymethod.set_signal_mask">set_signal_mask</a></li><li><a href="#tymethod.take_run_handle">take_run_handle</a></li><li><a href="#tymethod.try_clone">try_clone</a></li></ul></div><div class="block"><h3 class="sidebar-title"><a href="#implementations">Methods</a></h3><ul><li><a href="#method.downcast">downcast</a></li><li><a href="#method.downcast_arc">downcast_arc</a></li><li><a href="#method.downcast_mut">downcast_mut</a></li><li><a href="#method.downcast_rc">downcast_rc</a></li><li><a href="#method.downcast_ref">downcast_ref</a></li><li><a href="#method.is">is</a></li></ul></div><div class="block"><h3 class="sidebar-title"><a href="#implementors">Implementors</a></h3></div></section><h2 class="location"><a href="index.html">In hypervisor</a></h2><div id="sidebar-vars" data-name="Vcpu" data-ty="trait" data-relpath=""></div><script defer src="sidebar-items.js"></script></div></nav><main><div class="width-limiter"><div class="sub-container"><a class="sub-logo-container" href="../hypervisor/index.html"><img class="rust-logo" src="../rust-logo.svg" alt="logo"></a><nav class="sub"><div class="theme-picker hidden"><button id="theme-picker" aria-label="Pick another theme!" aria-haspopup="menu" title="themes"><img width="22" height="22" alt="Pick another theme!" src="../brush.svg"></button><div id="theme-choices" role="menu"></div></div><form class="search-form"><div class="search-container"><span></span><input class="search-input" name="search" autocomplete="off" spellcheck="false" placeholder="Click or press ‘S’ to search, ‘?’ for more options…" type="search"><button type="button" id="help-button" title="help">?</button><a id="settings-menu" href="../settings.html" title="settings"><img width="22" height="22" alt="Change settings" src="../wheel.svg"></a></div></form></nav></div><section id="main-content" class="content"><div class="main-heading">
    <h1 class="fqn"><span class="in-band">Trait <a href="index.html">hypervisor</a>::<wbr><a class="trait" href="#">Vcpu</a><button id="copy-path" onclick="copy_path(this)" title="Copy item path to clipboard"><img src="../clipboard.svg" width="19" height="18" alt="Copy item path"></button></span></h1><span class="out-of-band"><a class="srclink" href="../src/hypervisor/lib.rs.html#271-371">source</a> · <a id="toggle-all-docs" href="javascript:void(0)" title="collapse all docs">[<span class="inner">&#x2212;</span>]</a></span></div><div class="docblock item-decl"><pre class="rust trait"><code>pub trait Vcpu: DowncastSync {
<details class="rustdoc-toggle type-contents-toggle"><summary class="hideme"><span>Show 16 methods</span></summary>    fn <a href="#tymethod.try_clone" class="fnname">try_clone</a>(&amp;self) -&gt; <a class="type" href="../base/errno/type.Result.html" title="type base::errno::Result">Result</a>&lt;Self&gt;<br>&nbsp;&nbsp;&nbsp; <span class="where">where<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Self: <a class="trait" href="https://doc.rust-lang.org/1.60.0/core/marker/trait.Sized.html" title="trait core::marker::Sized">Sized</a></span>;
<div class="item-spacer"></div>    fn <a href="#tymethod.as_vcpu" class="fnname">as_vcpu</a>(&amp;self) -&gt; &amp;dyn <a class="trait" href="trait.Vcpu.html" title="trait hypervisor::Vcpu">Vcpu</a>;
<div class="item-spacer"></div>    fn <a href="#tymethod.take_run_handle" class="fnname">take_run_handle</a>(<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;self, <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;signal_num: <a class="enum" href="https://doc.rust-lang.org/1.60.0/core/option/enum.Option.html" title="enum core::option::Option">Option</a>&lt;<a class="type" href="https://doc.rust-lang.org/1.60.0/std/os/raw/type.c_int.html" title="type std::os::raw::c_int">c_int</a>&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;) -&gt; <a class="type" href="../base/errno/type.Result.html" title="type base::errno::Result">Result</a>&lt;<a class="struct" href="struct.VcpuRunHandle.html" title="struct hypervisor::VcpuRunHandle">VcpuRunHandle</a>&gt;;
<div class="item-spacer"></div>    fn <a href="#tymethod.run" class="fnname">run</a>(&amp;mut self, run_handle: &amp;<a class="struct" href="struct.VcpuRunHandle.html" title="struct hypervisor::VcpuRunHandle">VcpuRunHandle</a>) -&gt; <a class="type" href="../base/errno/type.Result.html" title="type base::errno::Result">Result</a>&lt;<a class="enum" href="enum.VcpuExit.html" title="enum hypervisor::VcpuExit">VcpuExit</a>&gt;;
<div class="item-spacer"></div>    fn <a href="#tymethod.id" class="fnname">id</a>(&amp;self) -&gt; <a class="primitive" href="https://doc.rust-lang.org/1.60.0/std/primitive.usize.html">usize</a>;
<div class="item-spacer"></div>    fn <a href="#tymethod.set_immediate_exit" class="fnname">set_immediate_exit</a>(&amp;self, exit: <a class="primitive" href="https://doc.rust-lang.org/1.60.0/std/primitive.bool.html">bool</a>);
<div class="item-spacer"></div>    fn <a href="#tymethod.set_local_immediate_exit" class="fnname">set_local_immediate_exit</a>(exit: <a class="primitive" href="https://doc.rust-lang.org/1.60.0/std/primitive.bool.html">bool</a>)<br>&nbsp;&nbsp;&nbsp; <span class="where">where<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Self: <a class="trait" href="https://doc.rust-lang.org/1.60.0/core/marker/trait.Sized.html" title="trait core::marker::Sized">Sized</a></span>;
<div class="item-spacer"></div>    fn <a href="#tymethod.set_local_immediate_exit_fn" class="fnname">set_local_immediate_exit_fn</a>(&amp;self) -&gt; extern &quot;C&quot; <a class="primitive" href="https://doc.rust-lang.org/1.60.0/std/primitive.fn.html">fn</a>();
<div class="item-spacer"></div>    fn <a href="#tymethod.handle_mmio" class="fnname">handle_mmio</a>(<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;self, <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;handle_fn: &amp;mut dyn <a class="trait" href="https://doc.rust-lang.org/1.60.0/core/ops/function/trait.FnMut.html" title="trait core::ops::function::FnMut">FnMut</a>(<a class="struct" href="struct.IoParams.html" title="struct hypervisor::IoParams">IoParams</a>) -&gt; <a class="enum" href="https://doc.rust-lang.org/1.60.0/core/option/enum.Option.html" title="enum core::option::Option">Option</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/1.60.0/std/primitive.array.html">[</a><a class="primitive" href="https://doc.rust-lang.org/1.60.0/std/primitive.u8.html">u8</a><a class="primitive" href="https://doc.rust-lang.org/1.60.0/std/primitive.array.html">; 8]</a>&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;) -&gt; <a class="type" href="../base/errno/type.Result.html" title="type base::errno::Result">Result</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/1.60.0/std/primitive.unit.html">()</a>&gt;;
<div class="item-spacer"></div>    fn <a href="#tymethod.handle_io" class="fnname">handle_io</a>(<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;self, <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;handle_fn: &amp;mut dyn <a class="trait" href="https://doc.rust-lang.org/1.60.0/core/ops/function/trait.FnMut.html" title="trait core::ops::function::FnMut">FnMut</a>(<a class="struct" href="struct.IoParams.html" title="struct hypervisor::IoParams">IoParams</a>) -&gt; <a class="enum" href="https://doc.rust-lang.org/1.60.0/core/option/enum.Option.html" title="enum core::option::Option">Option</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/1.60.0/std/primitive.array.html">[</a><a class="primitive" href="https://doc.rust-lang.org/1.60.0/std/primitive.u8.html">u8</a><a class="primitive" href="https://doc.rust-lang.org/1.60.0/std/primitive.array.html">; 8]</a>&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;) -&gt; <a class="type" href="../base/errno/type.Result.html" title="type base::errno::Result">Result</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/1.60.0/std/primitive.unit.html">()</a>&gt;;
<div class="item-spacer"></div>    fn <a href="#tymethod.handle_hyperv_hypercall" class="fnname">handle_hyperv_hypercall</a>(<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;self, <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;func: &amp;mut dyn <a class="trait" href="https://doc.rust-lang.org/1.60.0/core/ops/function/trait.FnMut.html" title="trait core::ops::function::FnMut">FnMut</a>(<a class="enum" href="enum.HypervHypercall.html" title="enum hypervisor::HypervHypercall">HypervHypercall</a>) -&gt; <a class="primitive" href="https://doc.rust-lang.org/1.60.0/std/primitive.u64.html">u64</a><br>&nbsp;&nbsp;&nbsp;&nbsp;) -&gt; <a class="type" href="../base/errno/type.Result.html" title="type base::errno::Result">Result</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/1.60.0/std/primitive.unit.html">()</a>&gt;;
<div class="item-spacer"></div>    fn <a href="#tymethod.handle_rdmsr" class="fnname">handle_rdmsr</a>(&amp;self, data: <a class="primitive" href="https://doc.rust-lang.org/1.60.0/std/primitive.u64.html">u64</a>) -&gt; <a class="type" href="../base/errno/type.Result.html" title="type base::errno::Result">Result</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/1.60.0/std/primitive.unit.html">()</a>&gt;;
<div class="item-spacer"></div>    fn <a href="#tymethod.handle_wrmsr" class="fnname">handle_wrmsr</a>(&amp;self);
<div class="item-spacer"></div>    fn <a href="#tymethod.pvclock_ctrl" class="fnname">pvclock_ctrl</a>(&amp;self) -&gt; <a class="type" href="../base/errno/type.Result.html" title="type base::errno::Result">Result</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/1.60.0/std/primitive.unit.html">()</a>&gt;;
<div class="item-spacer"></div>    fn <a href="#tymethod.set_signal_mask" class="fnname">set_signal_mask</a>(&amp;self, signals: <a class="primitive" href="https://doc.rust-lang.org/1.60.0/std/primitive.slice.html">&amp;[</a><a class="type" href="https://doc.rust-lang.org/1.60.0/std/os/raw/type.c_int.html" title="type std::os::raw::c_int">c_int</a><a class="primitive" href="https://doc.rust-lang.org/1.60.0/std/primitive.slice.html">]</a>) -&gt; <a class="type" href="../base/errno/type.Result.html" title="type base::errno::Result">Result</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/1.60.0/std/primitive.unit.html">()</a>&gt;;
<div class="item-spacer"></div>    unsafe fn <a href="#tymethod.enable_raw_capability" class="fnname">enable_raw_capability</a>(<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;self, <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cap: <a class="primitive" href="https://doc.rust-lang.org/1.60.0/std/primitive.u32.html">u32</a>, <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;args: &amp;<a class="primitive" href="https://doc.rust-lang.org/1.60.0/std/primitive.array.html">[</a><a class="primitive" href="https://doc.rust-lang.org/1.60.0/std/primitive.u64.html">u64</a><a class="primitive" href="https://doc.rust-lang.org/1.60.0/std/primitive.array.html">; 4]</a><br>&nbsp;&nbsp;&nbsp;&nbsp;) -&gt; <a class="type" href="../base/errno/type.Result.html" title="type base::errno::Result">Result</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/1.60.0/std/primitive.unit.html">()</a>&gt;;
</details>}</code></pre></div><details class="rustdoc-toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><p>A virtual CPU holding a virtualized hardware thread’s state, such as registers and interrupt
state, which may be used to execute virtual machines.</p>
<p>To run, <code>take_run_handle</code> must be called to lock the vcpu to a thread. Then the returned
<code>VcpuRunHandle</code> can be used for running.</p>
</div></details><h2 id="required-methods" class="small-section-header">Required methods<a href="#required-methods" class="anchor"></a></h2><div class="methods"><details class="rustdoc-toggle" open><summary><div id="tymethod.try_clone" class="method has-srclink"><div class="rightside"><a class="srclink" href="../src/hypervisor/lib.rs.html#273-275">source</a></div><h4 class="code-header">fn <a href="#tymethod.try_clone" class="fnname">try_clone</a>(&amp;self) -&gt; <a class="type" href="../base/errno/type.Result.html" title="type base::errno::Result">Result</a>&lt;Self&gt; <span class="where fmt-newline">where<br>&nbsp;&nbsp;&nbsp;&nbsp;Self: <a class="trait" href="https://doc.rust-lang.org/1.60.0/core/marker/trait.Sized.html" title="trait core::marker::Sized">Sized</a>,&nbsp;</span></h4></div></summary><div class="docblock"><p>Makes a shallow clone of this <code>Vcpu</code>.</p>
</div></details><details class="rustdoc-toggle" open><summary><div id="tymethod.as_vcpu" class="method has-srclink"><div class="rightside"><a class="srclink" href="../src/hypervisor/lib.rs.html#278">source</a></div><h4 class="code-header">fn <a href="#tymethod.as_vcpu" class="fnname">as_vcpu</a>(&amp;self) -&gt; &amp;dyn <a class="trait" href="trait.Vcpu.html" title="trait hypervisor::Vcpu">Vcpu</a></h4></div></summary><div class="docblock"><p>Casts this architecture specific trait object to the base trait object <code>Vcpu</code>.</p>
</div></details><details class="rustdoc-toggle" open><summary><div id="tymethod.take_run_handle" class="method has-srclink"><div class="rightside"><a class="srclink" href="../src/hypervisor/lib.rs.html#287">source</a></div><h4 class="code-header">fn <a href="#tymethod.take_run_handle" class="fnname">take_run_handle</a>(&amp;self, signal_num: <a class="enum" href="https://doc.rust-lang.org/1.60.0/core/option/enum.Option.html" title="enum core::option::Option">Option</a>&lt;<a class="type" href="https://doc.rust-lang.org/1.60.0/std/os/raw/type.c_int.html" title="type std::os::raw::c_int">c_int</a>&gt;) -&gt; <a class="type" href="../base/errno/type.Result.html" title="type base::errno::Result">Result</a>&lt;<a class="struct" href="struct.VcpuRunHandle.html" title="struct hypervisor::VcpuRunHandle">VcpuRunHandle</a>&gt;</h4></div></summary><div class="docblock"><p>Returns a unique <code>VcpuRunHandle</code>. A <code>VcpuRunHandle</code> is required to run the guest.</p>
<p>Assigns a vcpu to the current thread so that signal handlers can call
set_local_immediate_exit().  An optional signal number will be temporarily blocked while
assigning the vcpu to the thread and later blocked when <code>VcpuRunHandle</code> is destroyed.</p>
<p>Returns an error, <code>EBUSY</code>, if the current thread already contains a Vcpu.</p>
</div></details><details class="rustdoc-toggle" open><summary><div id="tymethod.run" class="method has-srclink"><div class="rightside"><a class="srclink" href="../src/hypervisor/lib.rs.html#294">source</a></div><h4 class="code-header">fn <a href="#tymethod.run" class="fnname">run</a>(&amp;mut self, run_handle: &amp;<a class="struct" href="struct.VcpuRunHandle.html" title="struct hypervisor::VcpuRunHandle">VcpuRunHandle</a>) -&gt; <a class="type" href="../base/errno/type.Result.html" title="type base::errno::Result">Result</a>&lt;<a class="enum" href="enum.VcpuExit.html" title="enum hypervisor::VcpuExit">VcpuExit</a>&gt;</h4></div></summary><div class="docblock"><p>Runs the VCPU until it exits, returning the reason for the exit.</p>
<p>Note that the state of the VCPU and associated VM must be setup first for this to do
anything useful. The given <code>run_handle</code> must be the same as the one returned by
<code>take_run_handle</code> for this <code>Vcpu</code>.</p>
</div></details><details class="rustdoc-toggle" open><summary><div id="tymethod.id" class="method has-srclink"><div class="rightside"><a class="srclink" href="../src/hypervisor/lib.rs.html#297">source</a></div><h4 class="code-header">fn <a href="#tymethod.id" class="fnname">id</a>(&amp;self) -&gt; <a class="primitive" href="https://doc.rust-lang.org/1.60.0/std/primitive.usize.html">usize</a></h4></div></summary><div class="docblock"><p>Returns the vcpu id.</p>
</div></details><details class="rustdoc-toggle" open><summary><div id="tymethod.set_immediate_exit" class="method has-srclink"><div class="rightside"><a class="srclink" href="../src/hypervisor/lib.rs.html#300">source</a></div><h4 class="code-header">fn <a href="#tymethod.set_immediate_exit" class="fnname">set_immediate_exit</a>(&amp;self, exit: <a class="primitive" href="https://doc.rust-lang.org/1.60.0/std/primitive.bool.html">bool</a>)</h4></div></summary><div class="docblock"><p>Sets the bit that requests an immediate exit.</p>
</div></details><details class="rustdoc-toggle" open><summary><div id="tymethod.set_local_immediate_exit" class="method has-srclink"><div class="rightside"><a class="srclink" href="../src/hypervisor/lib.rs.html#303-305">source</a></div><h4 class="code-header">fn <a href="#tymethod.set_local_immediate_exit" class="fnname">set_local_immediate_exit</a>(exit: <a class="primitive" href="https://doc.rust-lang.org/1.60.0/std/primitive.bool.html">bool</a>) <span class="where fmt-newline">where<br>&nbsp;&nbsp;&nbsp;&nbsp;Self: <a class="trait" href="https://doc.rust-lang.org/1.60.0/core/marker/trait.Sized.html" title="trait core::marker::Sized">Sized</a>,&nbsp;</span></h4></div></summary><div class="docblock"><p>Sets/clears the bit for immediate exit for the vcpu on the current thread.</p>
</div></details><details class="rustdoc-toggle" open><summary><div id="tymethod.set_local_immediate_exit_fn" class="method has-srclink"><div class="rightside"><a class="srclink" href="../src/hypervisor/lib.rs.html#309">source</a></div><h4 class="code-header">fn <a href="#tymethod.set_local_immediate_exit_fn" class="fnname">set_local_immediate_exit_fn</a>(&amp;self) -&gt; extern &quot;C&quot; <a class="primitive" href="https://doc.rust-lang.org/1.60.0/std/primitive.fn.html">fn</a>()</h4></div></summary><div class="docblock"><p>Returns a function pointer that invokes <code>set_local_immediate_exit</code> in a
signal-safe way when called.</p>
</div></details><details class="rustdoc-toggle" open><summary><div id="tymethod.handle_mmio" class="method has-srclink"><div class="rightside"><a class="srclink" href="../src/hypervisor/lib.rs.html#319">source</a></div><h4 class="code-header">fn <a href="#tymethod.handle_mmio" class="fnname">handle_mmio</a>(<br>&nbsp;&nbsp;&nbsp;&nbsp;&amp;self, <br>&nbsp;&nbsp;&nbsp;&nbsp;handle_fn: &amp;mut dyn <a class="trait" href="https://doc.rust-lang.org/1.60.0/core/ops/function/trait.FnMut.html" title="trait core::ops::function::FnMut">FnMut</a>(<a class="struct" href="struct.IoParams.html" title="struct hypervisor::IoParams">IoParams</a>) -&gt; <a class="enum" href="https://doc.rust-lang.org/1.60.0/core/option/enum.Option.html" title="enum core::option::Option">Option</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/1.60.0/std/primitive.array.html">[</a><a class="primitive" href="https://doc.rust-lang.org/1.60.0/std/primitive.u8.html">u8</a><a class="primitive" href="https://doc.rust-lang.org/1.60.0/std/primitive.array.html">; 8]</a>&gt;<br>) -&gt; <a class="type" href="../base/errno/type.Result.html" title="type base::errno::Result">Result</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/1.60.0/std/primitive.unit.html">()</a>&gt;</h4></div></summary><div class="docblock"><p>Handles an incoming MMIO request from the guest.</p>
<p>This function should be called after <code>Vcpu::run</code> returns <code>VcpuExit::Mmio</code>, and in the same
thread as run().</p>
<p>Once called, it will determine whether a MMIO read or MMIO write was the reason for the MMIO
exit, call <code>handle_fn</code> with the respective IoParams to perform the MMIO read or write, and
set the return data in the vcpu so that the vcpu can resume running.</p>
</div></details><details class="rustdoc-toggle" open><summary><div id="tymethod.handle_io" class="method has-srclink"><div class="rightside"><a class="srclink" href="../src/hypervisor/lib.rs.html#329">source</a></div><h4 class="code-header">fn <a href="#tymethod.handle_io" class="fnname">handle_io</a>(<br>&nbsp;&nbsp;&nbsp;&nbsp;&amp;self, <br>&nbsp;&nbsp;&nbsp;&nbsp;handle_fn: &amp;mut dyn <a class="trait" href="https://doc.rust-lang.org/1.60.0/core/ops/function/trait.FnMut.html" title="trait core::ops::function::FnMut">FnMut</a>(<a class="struct" href="struct.IoParams.html" title="struct hypervisor::IoParams">IoParams</a>) -&gt; <a class="enum" href="https://doc.rust-lang.org/1.60.0/core/option/enum.Option.html" title="enum core::option::Option">Option</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/1.60.0/std/primitive.array.html">[</a><a class="primitive" href="https://doc.rust-lang.org/1.60.0/std/primitive.u8.html">u8</a><a class="primitive" href="https://doc.rust-lang.org/1.60.0/std/primitive.array.html">; 8]</a>&gt;<br>) -&gt; <a class="type" href="../base/errno/type.Result.html" title="type base::errno::Result">Result</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/1.60.0/std/primitive.unit.html">()</a>&gt;</h4></div></summary><div class="docblock"><p>Handles an incoming PIO from the guest.</p>
<p>This function should be called after <code>Vcpu::run</code> returns <code>VcpuExit::Io</code>, and in the same
thread as run().</p>
<p>Once called, it will determine whether an input or output was the reason for the Io exit,
call <code>handle_fn</code> with the respective IoParams to perform the input/output operation, and set
the return data in the vcpu so that the vcpu can resume running.</p>
</div></details><details class="rustdoc-toggle" open><summary><div id="tymethod.handle_hyperv_hypercall" class="method has-srclink"><div class="rightside"><a class="srclink" href="../src/hypervisor/lib.rs.html#338">source</a></div><h4 class="code-header">fn <a href="#tymethod.handle_hyperv_hypercall" class="fnname">handle_hyperv_hypercall</a>(<br>&nbsp;&nbsp;&nbsp;&nbsp;&amp;self, <br>&nbsp;&nbsp;&nbsp;&nbsp;func: &amp;mut dyn <a class="trait" href="https://doc.rust-lang.org/1.60.0/core/ops/function/trait.FnMut.html" title="trait core::ops::function::FnMut">FnMut</a>(<a class="enum" href="enum.HypervHypercall.html" title="enum hypervisor::HypervHypercall">HypervHypercall</a>) -&gt; <a class="primitive" href="https://doc.rust-lang.org/1.60.0/std/primitive.u64.html">u64</a><br>) -&gt; <a class="type" href="../base/errno/type.Result.html" title="type base::errno::Result">Result</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/1.60.0/std/primitive.unit.html">()</a>&gt;</h4></div></summary><div class="docblock"><p>Handles the HYPERV_HYPERCALL exit from a vcpu.</p>
<p>This function should be called after <code>Vcpu::run</code> returns <code>VcpuExit::HypervHcall</code>, and in the
same thread as run.</p>
<p>Once called, it will parse the appropriate input parameters to the provided function to
handle the hyperv call, and then set the return data into the vcpu so it can resume running.</p>
</div></details><details class="rustdoc-toggle" open><summary><div id="tymethod.handle_rdmsr" class="method has-srclink"><div class="rightside"><a class="srclink" href="../src/hypervisor/lib.rs.html#346">source</a></div><h4 class="code-header">fn <a href="#tymethod.handle_rdmsr" class="fnname">handle_rdmsr</a>(&amp;self, data: <a class="primitive" href="https://doc.rust-lang.org/1.60.0/std/primitive.u64.html">u64</a>) -&gt; <a class="type" href="../base/errno/type.Result.html" title="type base::errno::Result">Result</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/1.60.0/std/primitive.unit.html">()</a>&gt;</h4></div></summary><div class="docblock"><p>Handles a RDMSR exit from the guest.</p>
<p>This function should be called after <code>Vcpu::run</code> returns <code>VcpuExit::RdMsr</code>,
and in the same thread as run.</p>
<p>It will put <code>data</code> into the guest buffer and return.</p>
</div></details><details class="rustdoc-toggle" open><summary><div id="tymethod.handle_wrmsr" class="method has-srclink"><div class="rightside"><a class="srclink" href="../src/hypervisor/lib.rs.html#352">source</a></div><h4 class="code-header">fn <a href="#tymethod.handle_wrmsr" class="fnname">handle_wrmsr</a>(&amp;self)</h4></div></summary><div class="docblock"><p>Handles a WRMSR exit from the guest by removing any error indication for the operation.</p>
<p>This function should be called after <code>Vcpu::run</code> returns <code>VcpuExit::WrMsr</code>,
and in the same thread as run.</p>
</div></details><details class="rustdoc-toggle" open><summary><div id="tymethod.pvclock_ctrl" class="method has-srclink"><div class="rightside"><a class="srclink" href="../src/hypervisor/lib.rs.html#356">source</a></div><h4 class="code-header">fn <a href="#tymethod.pvclock_ctrl" class="fnname">pvclock_ctrl</a>(&amp;self) -&gt; <a class="type" href="../base/errno/type.Result.html" title="type base::errno::Result">Result</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/1.60.0/std/primitive.unit.html">()</a>&gt;</h4></div></summary><div class="docblock"><p>Signals to the hypervisor that this guest is being paused by userspace.  Only works on Vms
that support <code>VmCap::PvClockSuspend</code>.</p>
</div></details><details class="rustdoc-toggle" open><summary><div id="tymethod.set_signal_mask" class="method has-srclink"><div class="rightside"><a class="srclink" href="../src/hypervisor/lib.rs.html#361">source</a></div><h4 class="code-header">fn <a href="#tymethod.set_signal_mask" class="fnname">set_signal_mask</a>(&amp;self, signals: <a class="primitive" href="https://doc.rust-lang.org/1.60.0/std/primitive.slice.html">&amp;[</a><a class="type" href="https://doc.rust-lang.org/1.60.0/std/os/raw/type.c_int.html" title="type std::os::raw::c_int">c_int</a><a class="primitive" href="https://doc.rust-lang.org/1.60.0/std/primitive.slice.html">]</a>) -&gt; <a class="type" href="../base/errno/type.Result.html" title="type base::errno::Result">Result</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/1.60.0/std/primitive.unit.html">()</a>&gt;</h4></div></summary><div class="docblock"><p>Specifies set of signals that are blocked during execution of <code>RunnableVcpu::run</code>.  Signals
that are not blocked will cause run to return with <code>VcpuExit::Intr</code>.  Only works on Vms that
support <code>VmCap::SignalMask</code>.</p>
</div></details><details class="rustdoc-toggle" open><summary><div id="tymethod.enable_raw_capability" class="method has-srclink"><div class="rightside"><a class="srclink" href="../src/hypervisor/lib.rs.html#370">source</a></div><h4 class="code-header">unsafe fn <a href="#tymethod.enable_raw_capability" class="fnname">enable_raw_capability</a>(&amp;self, cap: <a class="primitive" href="https://doc.rust-lang.org/1.60.0/std/primitive.u32.html">u32</a>, args: &amp;<a class="primitive" href="https://doc.rust-lang.org/1.60.0/std/primitive.array.html">[</a><a class="primitive" href="https://doc.rust-lang.org/1.60.0/std/primitive.u64.html">u64</a><a class="primitive" href="https://doc.rust-lang.org/1.60.0/std/primitive.array.html">; 4]</a>) -&gt; <a class="type" href="../base/errno/type.Result.html" title="type base::errno::Result">Result</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/1.60.0/std/primitive.unit.html">()</a>&gt;</h4></div></summary><div class="docblock"><p>Enables a hypervisor-specific extension on this Vcpu.  <code>cap</code> is a constant defined by the
hypervisor API (e.g., kvm.h).  <code>args</code> are the arguments for enabling the feature, if any.</p>
<h5 id="safety"><a href="#safety">Safety</a></h5>
<p>This function is marked as unsafe because <code>args</code> may be interpreted as pointers for some
capabilities. The caller must ensure that any pointers passed in the <code>args</code> array are
allocated as the kernel expects, and that mutable pointers are owned.</p>
</div></details></div><h2 id="implementations" class="small-section-header">Implementations<a href="#implementations" class="anchor"></a></h2><details class="rustdoc-toggle implementors-toggle" open><summary><section id="impl" class="impl has-srclink"><span class="rightside"><a class="srclink" href="../src/hypervisor/lib.rs.html#373">source</a></span><a href="#impl" class="anchor"></a><h3 class="code-header in-band">impl dyn <a class="trait" href="trait.Vcpu.html" title="trait hypervisor::Vcpu">Vcpu</a></h3></section></summary><div class="impl-items"><details class="rustdoc-toggle method-toggle" open><summary><section id="method.is" class="method has-srclink"><span class="rightside"><a class="srclink" href="../src/hypervisor/lib.rs.html#373">source</a></span><a href="#method.is" class="anchor"></a><h4 class="code-header">pub fn <a href="#method.is" class="fnname">is</a>&lt;__T:&nbsp;<a class="trait" href="trait.Vcpu.html" title="trait hypervisor::Vcpu">Vcpu</a>&gt;(&amp;self) -&gt; <a class="primitive" href="https://doc.rust-lang.org/1.60.0/std/primitive.bool.html">bool</a></h4></section></summary><div class="docblock"><p>Returns true if the trait object wraps an object of type <code>__T</code>.</p>
</div></details><details class="rustdoc-toggle method-toggle" open><summary><section id="method.downcast" class="method has-srclink"><span class="rightside"><a class="srclink" href="../src/hypervisor/lib.rs.html#373">source</a></span><a href="#method.downcast" class="anchor"></a><h4 class="code-header">pub fn <a href="#method.downcast" class="fnname">downcast</a>&lt;__T:&nbsp;<a class="trait" href="trait.Vcpu.html" title="trait hypervisor::Vcpu">Vcpu</a>&gt;(self: <a class="struct" href="https://doc.rust-lang.org/1.60.0/alloc/boxed/struct.Box.html" title="struct alloc::boxed::Box">Box</a>&lt;Self&gt;) -&gt; <a class="enum" href="https://doc.rust-lang.org/1.60.0/core/result/enum.Result.html" title="enum core::result::Result">Result</a>&lt;<a class="struct" href="https://doc.rust-lang.org/1.60.0/alloc/boxed/struct.Box.html" title="struct alloc::boxed::Box">Box</a>&lt;__T&gt;, <a class="struct" href="https://doc.rust-lang.org/1.60.0/alloc/boxed/struct.Box.html" title="struct alloc::boxed::Box">Box</a>&lt;Self&gt;&gt;</h4></section></summary><div class="docblock"><p>Returns a boxed object from a boxed trait object if the underlying object is of type
<code>__T</code>. Returns the original boxed trait if it isn’t.</p>
</div></details><details class="rustdoc-toggle method-toggle" open><summary><section id="method.downcast_rc" class="method has-srclink"><span class="rightside"><a class="srclink" href="../src/hypervisor/lib.rs.html#373">source</a></span><a href="#method.downcast_rc" class="anchor"></a><h4 class="code-header">pub fn <a href="#method.downcast_rc" class="fnname">downcast_rc</a>&lt;__T:&nbsp;<a class="trait" href="trait.Vcpu.html" title="trait hypervisor::Vcpu">Vcpu</a>&gt;(self: <a class="struct" href="https://doc.rust-lang.org/1.60.0/alloc/rc/struct.Rc.html" title="struct alloc::rc::Rc">Rc</a>&lt;Self&gt;) -&gt; <a class="enum" href="https://doc.rust-lang.org/1.60.0/core/result/enum.Result.html" title="enum core::result::Result">Result</a>&lt;<a class="struct" href="https://doc.rust-lang.org/1.60.0/alloc/rc/struct.Rc.html" title="struct alloc::rc::Rc">Rc</a>&lt;__T&gt;, <a class="struct" href="https://doc.rust-lang.org/1.60.0/alloc/rc/struct.Rc.html" title="struct alloc::rc::Rc">Rc</a>&lt;Self&gt;&gt;</h4></section></summary><div class="docblock"><p>Returns an <code>Rc</code>-ed object from an <code>Rc</code>-ed trait object if the underlying object is of
type <code>__T</code>. Returns the original <code>Rc</code>-ed trait if it isn’t.</p>
</div></details><details class="rustdoc-toggle method-toggle" open><summary><section id="method.downcast_ref" class="method has-srclink"><span class="rightside"><a class="srclink" href="../src/hypervisor/lib.rs.html#373">source</a></span><a href="#method.downcast_ref" class="anchor"></a><h4 class="code-header">pub fn <a href="#method.downcast_ref" class="fnname">downcast_ref</a>&lt;__T:&nbsp;<a class="trait" href="trait.Vcpu.html" title="trait hypervisor::Vcpu">Vcpu</a>&gt;(&amp;self) -&gt; <a class="enum" href="https://doc.rust-lang.org/1.60.0/core/option/enum.Option.html" title="enum core::option::Option">Option</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/1.60.0/std/primitive.reference.html">&amp;</a>__T&gt;</h4></section></summary><div class="docblock"><p>Returns a reference to the object within the trait object if it is of type <code>__T</code>, or
<code>None</code> if it isn’t.</p>
</div></details><details class="rustdoc-toggle method-toggle" open><summary><section id="method.downcast_mut" class="method has-srclink"><span class="rightside"><a class="srclink" href="../src/hypervisor/lib.rs.html#373">source</a></span><a href="#method.downcast_mut" class="anchor"></a><h4 class="code-header">pub fn <a href="#method.downcast_mut" class="fnname">downcast_mut</a>&lt;__T:&nbsp;<a class="trait" href="trait.Vcpu.html" title="trait hypervisor::Vcpu">Vcpu</a>&gt;(&amp;mut self) -&gt; <a class="enum" href="https://doc.rust-lang.org/1.60.0/core/option/enum.Option.html" title="enum core::option::Option">Option</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/1.60.0/std/primitive.reference.html">&amp;mut </a>__T&gt;</h4></section></summary><div class="docblock"><p>Returns a mutable reference to the object within the trait object if it is of type
<code>__T</code>, or <code>None</code> if it isn’t.</p>
</div></details><details class="rustdoc-toggle method-toggle" open><summary><section id="method.downcast_arc" class="method has-srclink"><span class="rightside"><a class="srclink" href="../src/hypervisor/lib.rs.html#373">source</a></span><a href="#method.downcast_arc" class="anchor"></a><h4 class="code-header">pub fn <a href="#method.downcast_arc" class="fnname">downcast_arc</a>&lt;__T:&nbsp;<a class="trait" href="trait.Vcpu.html" title="trait hypervisor::Vcpu">Vcpu</a>&gt;(self: <a class="struct" href="https://doc.rust-lang.org/1.60.0/alloc/sync/struct.Arc.html" title="struct alloc::sync::Arc">Arc</a>&lt;Self&gt;) -&gt; <a class="enum" href="https://doc.rust-lang.org/1.60.0/core/result/enum.Result.html" title="enum core::result::Result">Result</a>&lt;<a class="struct" href="https://doc.rust-lang.org/1.60.0/alloc/sync/struct.Arc.html" title="struct alloc::sync::Arc">Arc</a>&lt;__T&gt;, <a class="struct" href="https://doc.rust-lang.org/1.60.0/alloc/sync/struct.Arc.html" title="struct alloc::sync::Arc">Arc</a>&lt;Self&gt;&gt; <span class="where fmt-newline">where<br>&nbsp;&nbsp;&nbsp;&nbsp;__T: <a class="trait" href="https://doc.rust-lang.org/1.60.0/core/any/trait.Any.html" title="trait core::any::Any">Any</a> + <a class="trait" href="https://doc.rust-lang.org/1.60.0/core/marker/trait.Send.html" title="trait core::marker::Send">Send</a> + <a class="trait" href="https://doc.rust-lang.org/1.60.0/core/marker/trait.Sync.html" title="trait core::marker::Sync">Sync</a>,&nbsp;</span></h4></section></summary><div class="docblock"><p>Returns an <code>Arc</code>-ed object from an <code>Arc</code>-ed trait object if the underlying object is of
type <code>__T</code>. Returns the original <code>Arc</code>-ed trait if it isn’t.</p>
</div></details></div></details><h2 id="implementors" class="small-section-header">Implementors<a href="#implementors" class="anchor"></a></h2><div class="item-list" id="implementors-list"><section id="impl-Vcpu" class="impl has-srclink"><span class="rightside"><a class="srclink" href="../src/hypervisor/kvm/mod.rs.html#733-1141">source</a></span><a href="#impl-Vcpu" class="anchor"></a><h3 class="code-header in-band">impl <a class="trait" href="trait.Vcpu.html" title="trait hypervisor::Vcpu">Vcpu</a> for <a class="struct" href="kvm/struct.KvmVcpu.html" title="struct hypervisor::kvm::KvmVcpu">KvmVcpu</a></h3></section></div><script type="text/javascript" src="../implementors/hypervisor/trait.Vcpu.js" async></script></section><section id="search" class="content hidden"></section></div></main><div id="rustdoc-vars" data-root-path="../" data-current-crate="hypervisor" data-themes="ayu,dark,light" data-resource-suffix="" data-rustdoc-version="1.60.0 (7737e0b5c 2022-04-04)" ></div>
</body></html>
<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="Group cores by their offsets that are within `in_sync_threshold` of each other."><meta name="keywords" content="rust, rustlang, rust-lang, group_core_offsets"><title>group_core_offsets in devices::tsc::grouping - Rust</title><link rel="stylesheet" type="text/css" href="../../../normalize.css"><link rel="stylesheet" type="text/css" href="../../../rustdoc.css" id="mainThemeStyle"><link rel="stylesheet" type="text/css" href="../../../light.css"  id="themeStyle"><link rel="stylesheet" type="text/css" href="../../../dark.css" disabled ><link rel="stylesheet" type="text/css" href="../../../ayu.css" disabled ><script id="default-settings" ></script><script src="../../../storage.js"></script><script src="../../../crates.js"></script><script defer src="../../../main.js"></script>
    <noscript><link rel="stylesheet" href="../../../noscript.css"></noscript><link rel="alternate icon" type="image/png" href="../../../favicon-16x16.png"><link rel="alternate icon" type="image/png" href="../../../favicon-32x32.png"><link rel="icon" type="image/svg+xml" href="../../../favicon.svg"><style type="text/css">#crate-search{background-image:url("../../../down-arrow.svg");}</style></head><body class="rustdoc fn"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="sidebar"><div class="sidebar-menu" role="button">&#9776;</div><a href='../../../devices/index.html'><div class='logo-container rust-logo'><img src='../../../rust-logo.png' alt='logo'></div></a><div class="sidebar-elems"><h2 class="location">Other items in<br><a href="../../index.html">devices</a>::<wbr><a href="../index.html">tsc</a>::<wbr><a href="index.html">grouping</a></h2><div id="sidebar-vars" data-name="group_core_offsets" data-ty="fn" data-relpath=""></div><script defer src="sidebar-items.js"></script></div></nav><div class="theme-picker"><button id="theme-picker" aria-label="Pick another theme!" aria-haspopup="menu" title="themes"><img width="18" height="18" alt="Pick another theme!" src="../../../brush.svg"></button><div id="theme-choices" role="menu"></div></div><nav class="sub"><form class="search-form"><div class="search-container"><div><select id="crate-search"><option value="All crates">All crates</option></select><input class="search-input" name="search" autocomplete="off" spellcheck="false" placeholder="Click or press ‘S’ to search, ‘?’ for more options…" type="search"></div><button type="button" id="help-button" title="help">?</button><a id="settings-menu" href="../../../settings.html" title="settings"><img width="18" height="18" alt="Change settings" src="../../../wheel.svg"></a></div></form></nav><section id="main" class="content"><h1 class="fqn"><span class="in-band">Function <a href="../../index.html">devices</a>::<wbr><a href="../index.html">tsc</a>::<wbr><a href="index.html">grouping</a>::<wbr><a class="fn" href="#">group_core_offsets</a><button id="copy-path" onclick="copy_path(this)" title="Copy item path to clipboard"><img src="../../../clipboard.svg" width="19" height="18" alt="Copy item path"></button></span><span class="out-of-band"><span id="render-detail"><a id="toggle-all-docs" href="javascript:void(0)" title="collapse all docs">[<span class="inner">&#x2212;</span>]</a></span><a class="srclink" href="../../../src/devices/tsc/grouping.rs.html#177-225" title="goto source code">[src]</a></span></h1><div class="docblock item-decl"><pre class="rust fn"><code>pub(super) fn group_core_offsets(<br>&nbsp;&nbsp;&nbsp;&nbsp;offsets: <a class="primitive" href="https://doc.rust-lang.org/1.58.1/std/primitive.slice.html">&amp;[</a><a class="primitive" href="https://doc.rust-lang.org/1.58.1/std/primitive.i128.html">i128</a><a class="primitive" href="https://doc.rust-lang.org/1.58.1/std/primitive.slice.html">]</a>, <br>&nbsp;&nbsp;&nbsp;&nbsp;in_sync_threshold: <a class="struct" href="https://doc.rust-lang.org/1.58.1/core/time/struct.Duration.html" title="struct core::time::Duration">Duration</a>, <br>&nbsp;&nbsp;&nbsp;&nbsp;tsc_frequency: <a class="primitive" href="https://doc.rust-lang.org/1.58.1/std/primitive.u64.html">u64</a><br>) -&gt; <a class="type" href="https://docs.rs/anyhow/1.0.58/anyhow/type.Result.html" title="type anyhow::Result">Result</a>&lt;<a class="struct" href="struct.CoreGrouping.html" title="struct devices::tsc::grouping::CoreGrouping">CoreGrouping</a>&gt;</code></pre></div><details class="rustdoc-toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><p>Group cores by their offsets that are within <code>in_sync_threshold</code> of each other.</p>
<p>This uses a generic integer grouping algorithm. Because we’re grouping within a threshold,
there are potentially multiple ways we can group the integers, and we want to find the “best”
grouping. Our definition of best grouping is:</p>
<ol>
<li>The grouping who’s largest group is the largest.</li>
<li>If there are multiple groupings with the same size largest group, take the one with the
fewest groups.</li>
</ol>
<p>We could naively generate all possible groupings by iterating through the sorted integers and,
for each grouping, either adding that integer as it’s own group or adding it to the last group
of that grouping. This could generate 2^N groupings, where N is the number of integers. Instead,
we still iterate through the sorted integers and, for each grouping, we add it to the last
group of that grouping. But we only add the integer as it’s own group to the current best
grouping. This optimization avoids creating groupings that we know will not be the “best”
grouping, because adding the integer as it’s own group means that all subsequent integers
cannot be grouped with the existing groups, and thus we only care about the optimal existing
groups.</p>
</div></details></section><section id="search" class="content hidden"></section><div id="rustdoc-vars" data-root-path="../../../" data-current-crate="devices" data-search-index-js="../../../search-index.js" data-search-js="../../../search.js"></div>
</body></html>
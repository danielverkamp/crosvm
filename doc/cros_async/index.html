<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="An Executor and future combinators based on operations that block on file descriptors."><meta name="keywords" content="rust, rustlang, rust-lang, cros_async"><title>cros_async - Rust</title><link rel="stylesheet" type="text/css" href="../normalize.css"><link rel="stylesheet" type="text/css" href="../rustdoc.css" id="mainThemeStyle"><link rel="stylesheet" type="text/css" href="../light.css"  id="themeStyle"><link rel="stylesheet" type="text/css" href="../dark.css" disabled ><link rel="stylesheet" type="text/css" href="../ayu.css" disabled ><script id="default-settings" ></script><script src="../storage.js"></script><script src="../crates.js"></script><script defer src="../main.js"></script>
    <noscript><link rel="stylesheet" href="../noscript.css"></noscript><link rel="alternate icon" type="image/png" href="../favicon-16x16.png"><link rel="alternate icon" type="image/png" href="../favicon-32x32.png"><link rel="icon" type="image/svg+xml" href="../favicon.svg"><style type="text/css">#crate-search{background-image:url("../down-arrow.svg");}</style></head><body class="rustdoc mod crate"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="sidebar"><div class="sidebar-menu" role="button">&#9776;</div><a href='../cros_async/index.html'><div class='logo-container rust-logo'><img src='../rust-logo.png' alt='logo'></div></a><h2 class="location">Crate cros_async</h2><div class="block version"><div class="narrow-helper"></div><p>Version 0.1.1</p></div><div class="sidebar-elems"><a id="all-types" href="all.html"><p>See all cros_async's items</p></a><div class="block items"><ul><li><a href="#modules">Modules</a></li><li><a href="#structs">Structs</a></li><li><a href="#enums">Enums</a></li><li><a href="#traits">Traits</a></li><li><a href="#functions">Functions</a></li><li><a href="#types">Type Definitions</a></li></ul></div><div id="sidebar-vars" data-name="cros_async" data-ty="mod" data-relpath=""></div><script defer src="sidebar-items.js"></script></div></nav><div class="theme-picker"><button id="theme-picker" aria-label="Pick another theme!" aria-haspopup="menu" title="themes"><img width="18" height="18" alt="Pick another theme!" src="../brush.svg"></button><div id="theme-choices" role="menu"></div></div><nav class="sub"><form class="search-form"><div class="search-container"><div><select id="crate-search"><option value="All crates">All crates</option></select><input class="search-input" name="search" autocomplete="off" spellcheck="false" placeholder="Click or press ‘S’ to search, ‘?’ for more options…" type="search"></div><button type="button" id="help-button" title="help">?</button><a id="settings-menu" href="../settings.html" title="settings"><img width="18" height="18" alt="Change settings" src="../wheel.svg"></a></div></form></nav><section id="main" class="content"><h1 class="fqn"><span class="in-band">Crate <a class="mod" href="#">cros_async</a><button id="copy-path" onclick="copy_path(this)" title="Copy item path to clipboard"><img src="../clipboard.svg" width="19" height="18" alt="Copy item path"></button></span><span class="out-of-band"><span id="render-detail"><a id="toggle-all-docs" href="javascript:void(0)" title="collapse all docs">[<span class="inner">&#x2212;</span>]</a></span><a class="srclink" href="../src/cros_async/lib.rs.html#5-483" title="goto source code">[src]</a></span></h1><details class="rustdoc-toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><p>An Executor and future combinators based on operations that block on file descriptors.</p>
<p>This crate is meant to be used with the <code>futures-rs</code> crate that provides further combinators
and utility functions to combine and manage futures. All futures will run until they block on a
file descriptor becoming readable or writable. Facilities are provided to register future
wakers based on such events.</p>
<h2 id="running-top-level-futures" class="section-header"><a href="#running-top-level-futures">Running top-level futures.</a></h2>
<p>Use helper functions based the desired behavior of your application.</p>
<h3 id="running-one-future" class="section-header"><a href="#running-one-future">Running one future.</a></h3>
<p>If there is only one top-level future to run, use the <a href="fn.run_one.html"><code>run_one</code></a> function.</p>
<h3 id="completing-one-of-several-futures" class="section-header"><a href="#completing-one-of-several-futures">Completing one of several futures.</a></h3>
<p>If there are several top level tasks that should run until any one completes, use the “select”
family of executor constructors. These return an <a href="trait.Executor.html"><code>Executor</code></a> whose <code>run</code>
function will return when the first future completes. The uncompleted futures will also be
returned so they can be run further or otherwise cleaned up. These functions are inspired by
the <code>select_all</code> function from futures-rs, but built to be run inside an FD based executor and
to poll only when necessary. See the docs for <a href="fn.select2.html"><code>select2</code></a>,
<a href="fn.select3.html"><code>select3</code></a>, <a href="fn.select4.html"><code>select4</code></a>, and <a href="fn.select5.html"><code>select5</code></a>.</p>
<h3 id="completing-all-of-several-futures" class="section-header"><a href="#completing-all-of-several-futures">Completing all of several futures.</a></h3>
<p>If there are several top level tasks that all need to be completed, use the “complete” family
of executor constructors. These return an <a href="trait.Executor.html"><code>Executor</code></a> whose <code>run</code>
function will return only once all the futures passed to it have completed. These functions are
inspired by the <code>join_all</code> function from futures-rs, but built to be run inside an FD based
executor and to poll only when necessary. See the docs for <a href="fn.complete2.html"><code>complete2</code></a>,
<a href="fn.complete3.html"><code>complete3</code></a>, <a href="fn.complete4.html"><code>complete4</code></a>, and
<a href="fn.complete5.html"><code>complete5</code></a>.</p>
<h2 id="implementing-new-fd-based-futures" class="section-header"><a href="#implementing-new-fd-based-futures">Implementing new FD-based futures.</a></h2>
<p>For URing implementations should provide an implementation of the <code>IoSource</code> trait.
For the FD executor, new futures can use the existing ability to poll a source to build async
functionality on top of.</p>
<h2 id="implementations-1" class="section-header"><a href="#implementations-1">Implementations</a></h2>
<p>Currently there are two paths for using the asynchronous IO. One uses a WaitContext and drives
futures based on the FDs signaling they are ready for the opteration. This method will exist so
long as kernels &lt; 5.4 are supported.
The other method submits operations to io_uring and is signaled when they complete. This is more
efficient, but only supported on kernel 5.4+.
If <code>IoSourceExt::new</code> is used to interface with async IO, then the correct backend will be chosen
automatically.</p>
<h2 id="examples" class="section-header"><a href="#examples">Examples</a></h2>
<p>See the docs for <code>IoSourceExt</code> if support for kernels &lt;5.4 is required. Focus on <code>UringSource</code> if
all systems have support for io_uring.</p>
</div></details><h2 id="reexports" class="small-section-header"><a href="#reexports">Re-exports</a></h2>
<div class="item-table"><div class="item-row"><div class="item-left import-item"><code>pub use sys::<a class="enum" href="sys/unix/executor/enum.Executor.html" title="enum cros_async::sys::unix::executor::Executor">Executor</a>;</code></div><div class="item-right docblock-short"></div></div><div class="item-row"><div class="item-left import-item"><code>pub use crate::sys::<a class="mod" href="sys/unix/async_types/index.html" title="mod cros_async::sys::unix::async_types">async_types</a>::*;</code></div><div class="item-right docblock-short"></div></div><div class="item-row"><div class="item-left import-item"><code>pub use mem::<a class="trait" href="mem/trait.BackingMemory.html" title="trait cros_async::mem::BackingMemory">BackingMemory</a>;</code></div><div class="item-right docblock-short"></div></div><div class="item-row"><div class="item-left import-item"><code>pub use mem::<a class="struct" href="mem/struct.MemRegion.html" title="struct cros_async::mem::MemRegion">MemRegion</a>;</code></div><div class="item-right docblock-short"></div></div><div class="item-row"><div class="item-left import-item"><code>pub use sys::<a class="fn" href="sys/unix/fn.run_one.html" title="fn cros_async::sys::unix::run_one">run_one</a>;</code></div><div class="item-right docblock-short"></div></div></div><h2 id="modules" class="small-section-header"><a href="#modules">Modules</a></h2>
<div class="item-table"><div class="item-row"><div class="item-left module-item"><a class="mod" href="async_types/index.html" title="cros_async::async_types mod">async_types</a></div><div class="item-right docblock-short"></div></div><div class="item-row"><div class="item-left module-item"><a class="mod" href="audio_streams_async/index.html" title="cros_async::audio_streams_async mod">audio_streams_async</a></div><div class="item-right docblock-short"><p>Implements the interface required by <code>audio_streams</code> using the cros_async Executor.</p>
</div></div><div class="item-row"><div class="item-left module-item"><a class="mod" href="blocking/index.html" title="cros_async::blocking mod">blocking</a></div><div class="item-right docblock-short"></div></div><div class="item-row"><div class="item-left module-item"><a class="mod" href="complete/index.html" title="cros_async::complete mod">complete</a></div><div class="item-right docblock-short"></div></div><div class="item-row"><div class="item-left module-item"><a class="mod" href="event/index.html" title="cros_async::event mod">event</a></div><div class="item-right docblock-short"></div></div><div class="item-row"><div class="item-left module-item"><a class="mod" href="io_ext/index.html" title="cros_async::io_ext mod">io_ext</a></div><div class="item-right docblock-short"><p><code>IoSourceExt</code></p>
</div></div><div class="item-row"><div class="item-left module-item"><a class="mod" href="mem/index.html" title="cros_async::mem mod">mem</a></div><div class="item-right docblock-short"></div></div><div class="item-row"><div class="item-left module-item"><a class="mod" href="queue/index.html" title="cros_async::queue mod">queue</a></div><div class="item-right docblock-short"></div></div><div class="item-row"><div class="item-left module-item"><a class="mod" href="select/index.html" title="cros_async::select mod">select</a></div><div class="item-right docblock-short"></div></div><div class="item-row"><div class="item-left module-item"><a class="mod" href="sync/index.html" title="cros_async::sync mod">sync</a></div><div class="item-right docblock-short"></div></div><div class="item-row"><div class="item-left module-item"><a class="mod" href="sys/index.html" title="cros_async::sys mod">sys</a></div><div class="item-right docblock-short"></div></div><div class="item-row"><div class="item-left module-item"><a class="mod" href="timer/index.html" title="cros_async::timer mod">timer</a></div><div class="item-right docblock-short"></div></div><div class="item-row"><div class="item-left module-item"><a class="mod" href="waker/index.html" title="cros_async::waker mod">waker</a></div><div class="item-right docblock-short"></div></div></div><h2 id="structs" class="small-section-header"><a href="#structs">Structs</a></h2>
<div class="item-table"><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.AsyncWrapper.html" title="cros_async::AsyncWrapper struct">AsyncWrapper</a></div><div class="item-right docblock-short"><p>Simple wrapper struct to implement IntoAsync on foreign types.</p>
</div></div><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.BlockingPool.html" title="cros_async::BlockingPool struct">BlockingPool</a></div><div class="item-right docblock-short"><p>A thread pool for running work that may block.</p>
</div></div><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.CancellableBlockingPool.html" title="cros_async::CancellableBlockingPool struct">CancellableBlockingPool</a></div><div class="item-right docblock-short"><p>A thread pool for running work that may block.</p>
</div></div><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.Empty.html" title="cros_async::Empty struct">Empty</a></div><div class="item-right docblock-short"></div></div><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.Event.html" title="cros_async::Event struct">Event</a></div><div class="item-right docblock-short"><p>See the <a href="../base/sys/unix/eventfd/struct.EventFd.html">platform-specific Event struct</a> for struct- and method-level
documentation.</p>
</div></div><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.EventAsync.html" title="cros_async::EventAsync struct">EventAsync</a></div><div class="item-right docblock-short"><p>An async version of <code>base::Event</code>.</p>
</div></div><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.RecvTubeAsync.html" title="cros_async::RecvTubeAsync struct">RecvTubeAsync</a></div><div class="item-right docblock-short"></div></div><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.SendTubeAsync.html" title="cros_async::SendTubeAsync struct">SendTubeAsync</a></div><div class="item-right docblock-short"></div></div><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.TimerAsync.html" title="cros_async::TimerAsync struct">TimerAsync</a></div><div class="item-right docblock-short"><p>An async version of base::Timer.</p>
</div></div></div><h2 id="enums" class="small-section-header"><a href="#enums">Enums</a></h2>
<div class="item-table"><div class="item-row"><div class="item-left module-item"><a class="enum" href="enum.AllocateMode.html" title="cros_async::AllocateMode enum">AllocateMode</a></div><div class="item-right docblock-short"></div></div><div class="item-row"><div class="item-left module-item"><a class="enum" href="enum.AsyncError.html" title="cros_async::AsyncError enum">AsyncError</a></div><div class="item-right docblock-short"></div></div><div class="item-row"><div class="item-left module-item"><a class="enum" href="enum.Error.html" title="cros_async::Error enum">Error</a></div><div class="item-right docblock-short"></div></div><div class="item-row"><div class="item-left module-item"><a class="enum" href="enum.SelectResult.html" title="cros_async::SelectResult enum">SelectResult</a></div><div class="item-right docblock-short"></div></div><div class="item-row"><div class="item-left module-item"><a class="enum" href="enum.TimeoutAction.html" title="cros_async::TimeoutAction enum">TimeoutAction</a></div><div class="item-right docblock-short"></div></div></div><h2 id="traits" class="small-section-header"><a href="#traits">Traits</a></h2>
<div class="item-table"><div class="item-row"><div class="item-left module-item"><a class="trait" href="trait.IntoAsync.html" title="cros_async::IntoAsync trait">IntoAsync</a></div><div class="item-right docblock-short"><p>Marker trait signifying that the implementor is suitable for use with
cros_async. Examples of this include File, and base::net::UnixSeqpacket.</p>
</div></div><div class="item-row"><div class="item-left module-item"><a class="trait" href="trait.IoSourceExt.html" title="cros_async::IoSourceExt trait">IoSourceExt</a></div><div class="item-right docblock-short"><p>Subtrait for general async IO.</p>
</div></div><div class="item-row"><div class="item-left module-item"><a class="trait" href="trait.ReadAsync.html" title="cros_async::ReadAsync trait">ReadAsync</a></div><div class="item-right docblock-short"><p>Ergonomic methods for async reads.</p>
</div></div><div class="item-row"><div class="item-left module-item"><a class="trait" href="trait.WriteAsync.html" title="cros_async::WriteAsync trait">WriteAsync</a></div><div class="item-right docblock-short"><p>Ergonomic methods for async writes.</p>
</div></div></div><h2 id="functions" class="small-section-header"><a href="#functions">Functions</a></h2>
<div class="item-table"><div class="item-row"><div class="item-left module-item"><a class="fn" href="fn.block_on.html" title="cros_async::block_on fn">block_on</a></div><div class="item-right docblock-short"><p>Run a future to completion on the current thread.</p>
</div></div><div class="item-row"><div class="item-left module-item"><a class="fn" href="fn.complete2.html" title="cros_async::complete2 fn">complete2</a></div><div class="item-right docblock-short"><p>Creates a combinator that runs the two given futures to completion, returning a tuple of the
outputs each yields.</p>
</div></div><div class="item-row"><div class="item-left module-item"><a class="fn" href="fn.complete3.html" title="cros_async::complete3 fn">complete3</a></div><div class="item-right docblock-short"><p>Creates a combinator that runs the three given futures to completion, returning a tuple of the
outputs each yields.</p>
</div></div><div class="item-row"><div class="item-left module-item"><a class="fn" href="fn.complete4.html" title="cros_async::complete4 fn">complete4</a></div><div class="item-right docblock-short"><p>Creates a combinator that runs the four given futures to completion, returning a tuple of the
outputs each yields.</p>
</div></div><div class="item-row"><div class="item-left module-item"><a class="fn" href="fn.complete5.html" title="cros_async::complete5 fn">complete5</a></div><div class="item-right docblock-short"><p>Creates a combinator that runs the five given futures to completion, returning a tuple of the
outputs each yields.</p>
</div></div><div class="item-row"><div class="item-left module-item"><a class="fn" href="fn.empty.html" title="cros_async::empty fn">empty</a></div><div class="item-right docblock-short"></div></div><div class="item-row"><div class="item-left module-item"><a class="fn" href="fn.select2.html" title="cros_async::select2 fn">select2</a></div><div class="item-right docblock-short"><p>Creates a combinator that runs the two given futures until one completes, returning a tuple
containing the result of the finished future and the still pending future.</p>
</div></div><div class="item-row"><div class="item-left module-item"><a class="fn" href="fn.select3.html" title="cros_async::select3 fn">select3</a></div><div class="item-right docblock-short"><p>Creates a combinator that runs the three given futures until one or more completes, returning a
tuple containing the result of the finished future(s) and the still pending future(s).</p>
</div></div><div class="item-row"><div class="item-left module-item"><a class="fn" href="fn.select4.html" title="cros_async::select4 fn">select4</a></div><div class="item-right docblock-short"><p>Creates a combinator that runs the four given futures until one or more completes, returning a
tuple containing the result of the finished future(s) and the still pending future(s).</p>
</div></div><div class="item-row"><div class="item-left module-item"><a class="fn" href="fn.select5.html" title="cros_async::select5 fn">select5</a></div><div class="item-right docblock-short"><p>Creates a combinator that runs the five given futures until one or more completes, returning a
tuple containing the result of the finished future(s) and the still pending future(s).</p>
</div></div><div class="item-row"><div class="item-left module-item"><a class="fn" href="fn.select6.html" title="cros_async::select6 fn">select6</a></div><div class="item-right docblock-short"><p>Creates a combinator that runs the six given futures until one or more completes, returning a
tuple containing the result of the finished future(s) and the still pending future(s).</p>
</div></div><div class="item-row"><div class="item-left module-item"><a class="fn" href="fn.select7.html" title="cros_async::select7 fn">select7</a></div><div class="item-right docblock-short"></div></div><div class="item-row"><div class="item-left module-item"><a class="fn" href="fn.unblock.html" title="cros_async::unblock fn">unblock</a></div><div class="item-right docblock-short"><p>Spawn a task to run in the <code>CancellableBlockingPool</code> static executor.</p>
</div></div><div class="item-row"><div class="item-left module-item"><a class="fn" href="fn.unblock_disarm.html" title="cros_async::unblock_disarm fn">unblock_disarm</a></div><div class="item-right docblock-short"><p>Marks all the queued and in-flight tasks as cancelled. Any tasks queued after <code>disarm</code>ing
will be cancelled.
Doesn’t not wait for all the tasks to get cancelled.</p>
</div></div></div><h2 id="types" class="small-section-header"><a href="#types">Type Definitions</a></h2>
<div class="item-table"><div class="item-row"><div class="item-left module-item"><a class="type" href="type.AsyncResult.html" title="cros_async::AsyncResult type">AsyncResult</a></div><div class="item-right docblock-short"></div></div><div class="item-row"><div class="item-left module-item"><a class="type" href="type.Result.html" title="cros_async::Result type">Result</a></div><div class="item-right docblock-short"></div></div></div></section><section id="search" class="content hidden"></section><div id="rustdoc-vars" data-root-path="../" data-current-crate="cros_async" data-search-index-js="../search-index.js" data-search-js="../search.js"></div>
</body></html>